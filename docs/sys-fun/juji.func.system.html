<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>juji.func.system documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Juji Built-in Functions</span> <span class="project-version">1.3.10</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1 "><a href="juji.func.nlp.html"><div class="inner"><span>juji.func.nlp</span></div></a></li><li class="depth-1 current"><a href="juji.func.system.html"><div class="inner"><span>juji.func.system</span></div></a></li><li class="depth-1 "><a href="juji.func.user.html"><div class="inner"><span>juji.func.user</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="juji.func.system.html#var--.3C-"><div class="inner"><span>-&lt;-</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var--.3C-.7C"><div class="inner"><span>-&lt;-|</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-.3C-"><div class="inner"><span>&lt;-</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-.3C-.7C"><div class="inner"><span>&lt;-|</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-.3E-"><div class="inner"><span>&gt;-</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-answer-text"><div class="inner"><span>answer-text</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-answer-value"><div class="inner"><span>answer-value</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-ask-for-more.3F"><div class="inner"><span>ask-for-more?</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-ask-question"><div class="inner"><span>ask-question</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-ask-question-gui"><div class="inner"><span>ask-question-gui</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-current-chat-progress"><div class="inner"><span>current-chat-progress</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-end-interview"><div class="inner"><span>end-interview</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-get-question-heading"><div class="inner"><span>get-question-heading</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-input-length"><div class="inner"><span>input-length</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-input-text"><div class="inner"><span>input-text</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-is-gui-question"><div class="inner"><span>is-gui-question</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-make-open-ended-question"><div class="inner"><span>make-open-ended-question</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-make-request"><div class="inner"><span>make-request</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-question-answered.3F"><div class="inner"><span>question-answered?</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-record-answer"><div class="inner"><span>record-answer</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-remaining-agenda-size"><div class="inner"><span>remaining-agenda-size</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-rep-name"><div class="inner"><span>rep-name</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-required.3F"><div class="inner"><span>required?</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-session-time-up.3F"><div class="inner"><span>session-time-up?</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-set-question-min-input-len"><div class="inner"><span>set-question-min-input-len</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-set-timer"><div class="inner"><span>set-timer</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-skip-all-subtopics"><div class="inner"><span>skip-all-subtopics</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-skip-next-subtopic"><div class="inner"><span>skip-next-subtopic</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-sleep-rep"><div class="inner"><span>sleep-rep</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-thin-text.3F"><div class="inner"><span>thin-text?</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-timer-expired.3F"><div class="inner"><span>timer-expired?</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-update-ask-for-more-counter"><div class="inner"><span>update-ask-for-more-counter</span></div></a></li><li class="depth-1"><a href="juji.func.system.html#var-wait-for-more-user-input"><div class="inner"><span>wait-for-more-user-input</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">juji.func.system</h1><div class="doc"><div class="markdown"><p>System related built-in functions</p></div></div><div class="public anchor" id="var--.3C-"><h3>-&lt;-</h3><div class="usage"><code>(-&lt;- rep sym value)</code></div><div class="doc"><div class="markdown"><p>Assign value to a topic specific variable <code>sym</code> and return the value.</p>
<p>This is the same as <code>-&lt;-|</code> except this variable only exists in the scope of the current topic and its followup-topics.</p></div></div></div><div class="public anchor" id="var--.3C-.7C"><h3>-&lt;-|</h3><div class="usage"><code>(-&lt;-| rep sym value)</code></div><div class="doc"><div class="markdown"><p>Assign value to a global variable <code>sym</code> and return the value.</p>
<p><strong>Example</strong></p>
<pre><code>;; The pattern below assigns value 5 to variable `?a`
;; If the pattern is used as trigger,
;; it will also trigger the corresponding action in the rule
[(-&lt;-| ?a (+ 2 3))]

;; later, anywhere in the chat, the following pattern
;; is able to retrieve the value stored in `?a`
[(&gt;- ?a)]
</code></pre></div></div></div><div class="public anchor" id="var-.3C-"><h3>&lt;-</h3><div class="usage"><code>(&lt;- rep sym value)</code></div><div class="doc"><div class="markdown"><p>Assign value to a topic specific variable <code>sym</code> and return <code>nil</code>.</p>
<p>This is the same as -&lt;- except it returns <code>nil</code>.</p></div></div></div><div class="public anchor" id="var-.3C-.7C"><h3>&lt;-|</h3><div class="usage"><code>(&lt;-| rep sym value)</code></div><div class="doc"><div class="markdown"><p>Assign value to a global variable <code>sym</code> and return <code>nil</code>.</p>
<p>This is the same as -&lt;-| except it returns <code>nil</code>.</p></div></div></div><div class="public anchor" id="var-.3E-"><h3>&gt;-</h3><div class="usage"><code>(&gt;- rep sym)</code></div><div class="doc"><div class="markdown"><p>Return value assigned to variable <code>sym</code>.</p></div></div></div><div class="public anchor" id="var-answer-text"><h3>answer-text</h3><div class="usage"><code>(answer-text rep qn)</code></div><div class="doc"><div class="markdown"><p>Retrieve the answer text for question <code>qn</code>.</p>
<p>For the current question in the conversation, its answer text may differ from the current user input because an answer text may be the concatenation of multiple rounds of user input.</p></div></div></div><div class="public anchor" id="var-answer-value"><h3>answer-value</h3><div class="usage"><code>(answer-value rep qn)</code></div><div class="doc"><div class="markdown"><p>Retrieve the answer value of question <code>qn</code>. Answer value is specific to choice questions.</p></div></div></div><div class="public anchor" id="var-ask-for-more.3F"><h3>ask-for-more?</h3><div class="usage"><code>(ask-for-more? rep question)</code><code>(ask-for-more? rep question threshold)</code></div><div class="doc"><div class="markdown"><p>Return true if the input is short and the number of asked for more has not yet reach the <code>threshold</code>. <code>threshold</code> is 1 if not provided. Usually used together with <code>update-ask-for-more-counter</code></p></div></div></div><div class="public anchor" id="var-ask-question"><h3>ask-question</h3><div class="usage"><code>(ask-question rep qn)</code><code>(ask-question rep qn wording)</code><code>(ask-question rep qn wording mode)</code></div><div class="doc"><div class="markdown"><p>Ask an open-ended question <code>qn</code>.</p>
<p>If <code>wording</code> (a string) is given, use it as the actual question wording; otherwise use the wording or heading from the defined question <code>qn</code>.</p>
<p><code>mode</code> can be <code>:first-time</code> or <code>:repeating</code>. <code>mode</code> only works when <code>wording</code> is <code>nil</code>.</p>
<ul>
  <li>if <code>:first-time</code>, wording of <code>qn</code> is used if available;</li>
  <li>if :repeating, heading of of <code>qn</code> is used.</li>
</ul>
<p><code>qn</code> is one of the question variables defined in script. See <a href="https://docs.juji.io/reference/#question">https://docs.juji.io/reference/#question</a> for detailed explaination on defining questions.</p></div></div></div><div class="public anchor" id="var-ask-question-gui"><h3>ask-question-gui</h3><div class="usage"><code>(ask-question-gui rep qn)</code></div><div class="doc"><div class="markdown"><p>Ask question <code>qn</code> in GUI form. GUI form is usually used for asking single choice and multiple choice questions.</p>
<p><code>qn</code> is one of the question variables defined in script. See <a href="https://docs.juji.io/reference/#question">https://docs.juji.io/reference/#question</a> for detailed explaination on defining questions.</p></div></div></div><div class="public anchor" id="var-current-chat-progress"><h3>current-chat-progress</h3><div class="usage"><code>(current-chat-progress rep)</code></div><div class="doc"><div class="markdown"><p>Show a precentage of completed agenda topics. Return a float between 0 and 1.0.</p></div></div></div><div class="public anchor" id="var-end-interview"><h3>end-interview</h3><div class="usage"><code>(end-interview rep)</code></div><div class="doc"><div class="markdown"><p>End the current interview and redirect to the post-chat page after short delay.</p></div></div></div><div class="public anchor" id="var-get-question-heading"><h3>get-question-heading</h3><div class="usage"><code>(get-question-heading rep question)</code></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-input-length"><h3>input-length</h3><div class="usage"><code>(input-length rep)</code></div><div class="doc"><div class="markdown"><p>Return the number of tokens contained in the user input.</p></div></div></div><div class="public anchor" id="var-input-text"><h3>input-text</h3><div class="usage"><code>(input-text rep)</code></div><div class="doc"><div class="markdown"><p>Return the text that user entered.</p></div></div></div><div class="public anchor" id="var-is-gui-question"><h3>is-gui-question</h3><div class="usage"><code>(is-gui-question rep qn)</code></div><div class="doc"><div class="markdown"><p>Check if <code>qn</code> is a GUI form friendly question (e.g., single choice, multiple choice question)</p>
<p><code>qn</code> is one of the question variables defined in script. See <a href="https://docs.juji.io/reference/#question">https://docs.juji.io/reference/#question</a> for detailed explaination on defining questions.</p></div></div></div><div class="public anchor" id="var-make-open-ended-question"><h3>make-open-ended-question</h3><div class="usage"><code>(make-open-ended-question rep question-id heading wording)</code><code>(make-open-ended-question rep question-id heading wording required?)</code></div><div class="doc"><div class="markdown"><p>This is a wrapper to create an question map that can be passed into <code>ask-question</code> and <code>record-answer</code> function. <code>question-id</code>, <code>heading</code> and <code>wording</code> are strings. <code>required?</code> is a boolean. The generated question has <code>:required</code> with value <code>true</code>.</p>
<p>Note that this question is not registered anywhere. This function is intended to be used for generating question in real-time.</p></div></div></div><div class="public anchor" id="var-make-request"><h3>make-request</h3><div class="usage"><code>(make-request rep base-url)</code><code>(make-request rep base-url query-map)</code><code>(make-request rep base-url query-map socket-timeout)</code></div><div class="doc"><div class="markdown"><p>Make request to given url composed by <code>base-url</code> and querys in <code>query-map</code>. Return the body of the request results. Return nil if the request is not successful.</p>
<p>The keys of <code>query-map</code> (if exists and not nil) are argument names, values are the corresponding argument values. The keys and values will be url-encoded when forming the request url (e.g., “a b” becomes “a%20b”).</p>
<p><code>socket-timeout</code> default to 10000, it is in milliseconds</p>
<pre><code>[(make-request "http://sampleweb.com:1234/abc/def" {:k1 "10", :k2 "20"})]
;; the pattern above would make a request to "http://sampleweb.com:1234/abc/def?k1=10&amp;k2=20" and return the request result
</code></pre></div></div></div><div class="public anchor" id="var-question-answered.3F"><h3>question-answered?</h3><div class="usage"><code>(question-answered? rep qn)</code></div><div class="doc"><div class="markdown"><p>Check if the question <code>qn</code> has any answer stored. Return the time of the answer if answered, otherwise, return <code>nil</code>.</p></div></div></div><div class="public anchor" id="var-record-answer"><h3>record-answer</h3><div class="usage"><code>(record-answer rep qn ans)</code></div><div class="doc"><div class="markdown"><p>Record <code>ans</code> as an answer of question <code>qn</code>. Only recorded answer will be show up in the results reports.</p>
<p>One quetion can have multiple rounds of user input record as its answer. They will be concatenated.</p>
<p>All Juji built-in library topics record acceptable user input as answer.</p>
<p><code>ans</code> can be a string or a vector of tokens.</p>
<p><strong>Example</strong></p>
<pre><code>;; The typical action below will first acknowledge user's input
;; then record his/her input as answer.
["Thank you!" (record-answer ?q (input-text))]
</code></pre></div></div></div><div class="public anchor" id="var-remaining-agenda-size"><h3>remaining-agenda-size</h3><div class="usage"><code>(remaining-agenda-size rep)</code></div><div class="doc"><div class="markdown"><p>Check the remaining agenda size (i.e., how many topics left on the agenda)</p></div></div></div><div class="public anchor" id="var-rep-name"><h3>rep-name</h3><div class="usage"><code>(rep-name rep)</code></div><div class="doc"><div class="markdown"><p>Return the name of the REP.</p></div></div></div><div class="public anchor" id="var-required.3F"><h3>required?</h3><div class="usage"><code>(required? rep question)</code></div><div class="doc"><div class="markdown"><p>Check if the question is required. Return a boolean. If the <code>:required</code> field is not set, default to <code>true</code>.</p></div></div></div><div class="public anchor" id="var-session-time-up.3F"><h3>session-time-up?</h3><div class="usage"><code>(session-time-up? rep)</code></div><div class="doc"><div class="markdown"><p>Checks if the current session time is reaching its end, as specified by <code>:session-duration-max</code> in <a href="https://docs.juji.io/reference/#config">script config</a>.</p></div></div></div><div class="public anchor" id="var-set-question-min-input-len"><h3>set-question-min-input-len</h3><div class="usage"><code>(set-question-min-input-len rep question threshold)</code></div><div class="doc"><div class="markdown"><p>Set <code>:question-min-input</code> value in the given <code>question</code> map. The value need to be an integer.</p></div></div></div><div class="public anchor" id="var-set-timer"><h3>set-timer</h3><div class="usage"><code>(set-timer rep var-name t)</code></div><div class="doc"><div class="markdown"><p>Set a timer at the <code>var-name</code> that expires <code>t</code> seconds from now, return <code>nil</code>.</p>
<p>This function is usually used with <code>timer-expired?</code></p></div></div></div><div class="public anchor" id="var-skip-all-subtopics"><h3>skip-all-subtopics</h3><div class="usage"><code>(skip-all-subtopics rep)</code></div><div class="doc"><div class="markdown"><p>Skip all sibling followup topics.</p></div></div></div><div class="public anchor" id="var-skip-next-subtopic"><h3>skip-next-subtopic</h3><div class="usage"><code>(skip-next-subtopic rep n)</code></div><div class="doc"><div class="markdown"><p>Skip the next <code>n</code> sibling followup topics.</p></div></div></div><div class="public anchor" id="var-sleep-rep"><h3>sleep-rep</h3><div class="usage"><code>(sleep-rep rep t)</code></div><div class="doc"><div class="markdown"><p>Make the REP sleep for <code>t</code> milliseconds, return an empty string.</p></div></div></div><div class="public anchor" id="var-thin-text.3F"><h3>thin-text?</h3><div class="usage"><code>(thin-text? rep question)</code><code>(thin-text? rep question input)</code></div><div class="doc"><div class="markdown"><p>Checks if the user input is thin, i.e. not saying much. This is first check against <code>:min-input-len</code> in the question map, if that does not exsit, <code>:thin-text-threshold</code> in script is used instead. The <code>input</code> is considered thin if less than the threshold. When <code>input</code> is not given, length in calculated using <code>input-length</code></p></div></div></div><div class="public anchor" id="var-timer-expired.3F"><h3>timer-expired?</h3><div class="usage"><code>(timer-expired? rep var-name)</code></div><div class="doc"><div class="markdown"><p>Check if the timer at the given <code>var-name</code> is expired.</p>
<p>This function is usually used with <code>set-timer</code></p></div></div></div><div class="public anchor" id="var-update-ask-for-more-counter"><h3>update-ask-for-more-counter</h3><div class="usage"><code>(update-ask-for-more-counter rep question)</code></div><div class="doc"><div class="markdown"><p>Update the ask-for-more counter. Increment the counter if it exists. Otherwise, set the counter to 1 if the question exists. Usually used together with <code>ask-for-more?</code></p></div></div></div><div class="public anchor" id="var-wait-for-more-user-input"><h3>wait-for-more-user-input</h3><div class="usage"><code>(wait-for-more-user-input rep)</code></div><div class="doc"><div class="markdown"><p>REP will wait for more user input, return <code>nil</code>.</p></div></div></div></div></body></html>